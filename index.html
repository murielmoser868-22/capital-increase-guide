<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Augmentation de Capital - Qonto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.5;
            color: #1a1a1a;
            background: #f5f5f7;
            font-size: 12px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 20px;
        }

        /* Header */
        .header {
            background: #461068;
            color: white;
            padding: 30px 30px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 1.1em;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .header p {
            font-size: 0.85em;
            opacity: 0.95;
        }

        /* Wizard Container */
        .wizard-container {
            background: white;
            border-radius: 16px;
            padding: 50px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            min-height: 500px;
        }

        /* Progress Bar */
        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 50px;
            position: relative;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 3px;
            background: #e9ecef;
            z-index: 1;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            height: 3px;
            background: #461068;
            transition: width 0.3s ease;
            z-index: 2;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
            z-index: 3;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .step.active .step-number {
            background: #461068;
            color: white;
            transform: scale(1.1);
        }

        .step.completed .step-number {
            background: #0D5563;
            color: white;
        }

        .step-label {
            font-size: 0.85em;
            color: #6c757d;
            text-align: center;
        }

        .step.active .step-label {
            color: #461068;
            font-weight: 600;
        }

        /* Question Section */
        .question-section {
            display: none;
        }

        .question-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-title {
            font-size: 1.05em;
            color: #1a1a1a;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .question-subtitle {
            color: #666;
            margin-bottom: 20px;
            font-size: 0.85em;
        }

        /* Option Cards */
        .option-card {
            background: #f8f9fa;
            border: 3px solid #e9ecef;
            border-radius: 12px;
            padding: 18px 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .option-card:hover {
            border-color: #7A250C;
            background: #FFC9A6;
            transform: translateX(5px);
        }

        .option-card.selected {
            border-color: #461068;
            border-width: 5px;
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(70, 16, 104, 0.3);
        }

        .option-card.selected::before {
            content: "‚úì S√©lectionn√©";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #461068;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .option-card input[type="radio"],
        .option-card input[type="checkbox"] {
            position: absolute;
            opacity: 0;
        }

        .option-title {
            font-size: 0.95em;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-description {
            color: #1a1a1a;
            font-size: 0.85em;
            line-height: 1.5;
        }

        /* Checkboxes */
        .checkbox-group {
            margin: 30px 0;
        }

        .checkbox-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .checkbox-card:hover {
            border-color: #7A250C;
            background: #FFC9A6;
        }

        .checkbox-card.checked {
            border-color: #7A250C;
            background: #FFC9A6;
        }

        .checkbox-card input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-top: 3px;
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-title {
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 5px;
        }

        .checkbox-description {
            color: #666;
            font-size: 0.85em;
        }

        /* Help Box */
        .help-box {
            background: #FFDFEA;
            border-left: 5px solid #093B75;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .help-box > strong {
            color: #093B75;
            display: block;
            margin-bottom: 10px;
            font-size: 0.85em;
        }

        .help-box p strong {
            color: inherit;
            display: inline;
        }

        .help-box p {
            color: #093B75;
            margin: 8px 0;
            line-height: 1.7;
        }

        .help-box ul {
            margin: 10px 0 10px 20px;
            color: #093B75;
        }

        .help-box li {
            margin: 5px 0;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn {
            padding: 10px 25px;
            border-radius: 8px;
            border: none;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #093B75;
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            background: #461068;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(70, 16, 104, 0.3);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-title {
            font-size: 1.2em;
            color: #461068;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 0.85em;
        }

        .doc-category {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            border-left: 5px solid #093B75;
        }

        .doc-category h3 {
            color: #093B75;
            margin-bottom: 20px;
            font-size: 0.85em;
        }

        .doc-item {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .doc-item-title {
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .doc-item-description {
            color: #6c757d;
            font-size: 0.85em;
            line-height: 1.6;
        }

        .doc-item-description a {
            color: #093B75;
            text-decoration: none;
            border-bottom: 1px dotted #093B75;
        }

        .doc-item-description a:hover {
            border-bottom-style: solid;
        }

        /* PM Tables in Results */
        .pm-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .pm-table thead {
            background: #093B75;
            color: white;
        }

        .pm-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.85em;
        }

        .pm-table td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
        }

        .pm-table tbody tr:hover {
            background: #f8f9fa;
        }

        .pm-table .doc-list {
            margin: 5px 0;
        }

        .summary-box {
            background: #D5C8FF;
            border: 2px solid #461068;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .summary-box h4 {
            color: #461068;
            margin-bottom: 15px;
        }

        .summary-box ul {
            margin-left: 20px;
            color: #461068;
        }

        .summary-box li {
            margin: 8px 0;
        }

        @media (max-width: 768px) {
            .wizard-container {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 1em;
            }

            .button-group {
                flex-direction: column;
            }
        }

        /* Print/PDF specific styles */
        @media print {
            /* Hide ALL navigation and interactive elements */
            .header,
            .progress-tracker,
            .progress-bar,
            .progress-line,
            .step-label,
            .question-section,
            button,
            .btn,
            .result-subtitle,
            .container > .header,
            .step-indicator {
                display: none !important;
            }

            /* Show only results */
            .results-section {
                display: block !important;
                max-width: 100%;
                padding: 0;
                margin: 0;
            }

            /* Optimize page layout */
            body {
                margin: 0;
                padding: 15px;
                background: white;
                font-size: 11pt;
            }

            .container {
                padding: 0 !important;
                margin: 0 !important;
            }

            /* Title styling for print */
            .result-title {
                color: #093B75;
                font-size: 20pt;
                margin-bottom: 15pt;
                margin-top: 0;
                page-break-after: avoid;
                font-weight: 700;
            }

            /* Summary box styling */
            .summary-box {
                background: #f8f9fa !important;
                border: 1pt solid #dee2e6 !important;
                padding: 12pt !important;
                margin-bottom: 15pt !important;
                border-radius: 4pt;
            }

            .summary-box h4 {
                font-size: 13pt !important;
                margin-top: 0 !important;
                margin-bottom: 8pt !important;
            }

            .summary-box ul {
                margin: 0 !important;
                padding-left: 20pt !important;
            }

            .summary-box li {
                font-size: 10pt !important;
                margin-bottom: 4pt !important;
            }

            /* Doc category headers */
            .doc-category h3,
            div[style*="background: #093B75"],
            div[style*="background: #FFC9A6"] {
                background: #f0f0f0 !important;
                color: #000 !important;
                padding: 10pt !important;
                margin-top: 12pt !important;
                margin-bottom: 0 !important;
                font-size: 12pt !important;
                font-weight: 700 !important;
                border: 1pt solid #ddd !important;
                border-bottom: none !important;
            }

            /* Doc items styling */
            .doc-item {
                background: white !important;
                border: 1pt solid #ddd !important;
                padding: 10pt !important;
                margin-bottom: 10pt !important;
                page-break-inside: avoid;
            }

            .doc-item-title {
                font-size: 11pt !important;
                font-weight: 600 !important;
                margin-bottom: 6pt !important;
                color: #000 !important;
            }

            .doc-item-description {
                font-size: 10pt !important;
                color: #333 !important;
                line-height: 1.4 !important;
            }

            /* Prevent page breaks inside important sections */
            .doc-item,
            .doc-category,
            .summary-box,
            .pm-table {
                page-break-inside: avoid;
            }

            /* Links styling for print */
            a {
                color: #093B75 !important;
                text-decoration: underline !important;
            }

            /* Print URLs after links but make them smaller */
            a[href]:after {
                content: " (" attr(href) ")";
                font-size: 7pt;
                color: #666;
                word-break: break-all;
            }

            /* Table styling */
            .pm-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 10pt;
            }

            .pm-table th,
            .pm-table td {
                border: 1pt solid #ddd !important;
                padding: 8pt !important;
                font-size: 9pt !important;
            }

            .pm-table th {
                background: #f0f0f0 !important;
                font-weight: 700 !important;
            }

            /* Help boxes */
            .help-box {
                background: #fffbea !important;
                border: 1pt solid #ffd900 !important;
                padding: 10pt !important;
                margin: 10pt 0 !important;
                font-size: 9pt !important;
            }

            /* Remove all shadows and effects */
            * {
                box-shadow: none !important;
                text-shadow: none !important;
            }

            /* Force consistent margins */
            h3, h4 {
                page-break-after: avoid;
            }

            /* Emoji and icons - keep them visible */
            .doc-item-title::before,
            .summary-box h4::before {
                display: inline !important;
            }
        }
    </style>
    <!-- jsPDF library for PDF generation with clickable links -->
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìã Documentation Augmentation de Capital</h1>
            <p>R√©pondez √† quelques questions pour identifier pr√©cis√©ment vos documents requis</p>
        </div>

        <!-- Wizard Container -->
        <div class="wizard-container">
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-line" id="progressLine"></div>
                <div class="step" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Situation</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Type</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">D√©tails</div>
                </div>
                <div class="step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">R√©sultats</div>
                </div>
            </div>

            <!-- Question 1: Number of participants -->
            <div class="question-section active" id="q1">
                <h2 class="question-title">Quelle est votre situation ?</h2>
                <p class="question-subtitle">S√©lectionnez l'option qui correspond √† votre cas</p>

                <div class="option-card" onclick="selectOption('q1', 'single-holder')">
                    <input type="radio" name="participants" value="single-holder" id="single-holder">
                    <div class="option-title">üë§ Un seul participant : moi, titulaire du compte</div>
                    <div class="option-description">
                        <strong>‚úÖ Cas simplifi√© :</strong> Je suis le seul √† participer √† l'augmentation de capital ET je suis le titulaire du compte Qonto
                    </div>
                </div>

                <div class="option-card" onclick="selectOption('q1', 'other')">
                    <input type="radio" name="participants" value="other" id="other">
                    <div class="option-title">üë• Autre situation</div>
                    <div class="option-description">
                        Toutes les autres situations :<br>
                        ‚Ä¢ Un seul participant qui n'est pas le titulaire du compte<br>
                        ‚Ä¢ Plusieurs participants (personnes physiques et/ou morales)<br>
                        ‚Ä¢ Combinaisons de participants
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="nextQuestion(1)" id="btn-q1" disabled>Suivant ‚Üí</button>
                </div>
            </div>

            <!-- Question 2: Type of participants -->
            <div class="question-section" id="q2">
                <h2 class="question-title">Quel type de participants ?</h2>
                <p class="question-subtitle">S√©lectionnez la composition de votre augmentation de capital</p>

                <div class="option-card" onclick="selectOption('q2', 'pp')">
                    <input type="radio" name="type" value="pp" id="pp">
                    <div class="option-title">üë§ Personnes Physiques uniquement</div>
                    <div class="option-description">Uniquement des particuliers (individus)</div>
                </div>

                <div class="option-card" onclick="selectOption('q2', 'pm')">
                    <input type="radio" name="type" value="pm" id="pm">
                    <div class="option-title">üè¢ Personnes Morales uniquement</div>
                    <div class="option-description">Uniquement des entit√©s (soci√©t√©s, associations, fonds, etc.)</div>
                </div>

                <div class="option-card" onclick="selectOption('q2', 'mix')">
                    <input type="radio" name="type" value="mix" id="mix">
                    <div class="option-title">üë• Mix Personnes Physiques & Morales</div>
                    <div class="option-description">√Ä la fois des particuliers et des entit√©s</div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevQuestion(2)">‚Üê Pr√©c√©dent</button>
                    <button class="btn btn-primary" onclick="nextQuestion(2)" id="btn-q2" disabled>Suivant ‚Üí</button>
                </div>
            </div>

            <!-- Question 3a: PP Details -->
            <div class="question-section" id="q3-pp">
                <h2 class="question-title">Question sur les Personnes Physiques</h2>
                <p class="question-subtitle">Une seule question pour d√©terminer vos documents</p>

                <div class="help-box">
                    <strong>üí° Qu'est-ce qu'un "b√©n√©ficiaire effectif" ?</strong>
                    <p style="margin: 10px 0 5px 0;">Un <strong style="display: inline;">b√©n√©ficiaire effectif (BE)</strong> est une personne qui :</p>
                    <ul>
                        <li>D√©tient ‚â• 25% du capital social, OU</li>
                        <li>D√©tient ‚â• 25% des droits de vote, OU</li>
                        <li>Exerce un contr√¥le effectif sur la soci√©t√© (via accords d'associ√©s, pactes, r√¥le de direction strat√©gique)</li>
                    </ul>
                </div>

                <div style="background: #fff; border: 3px solid #461068; border-radius: 12px; padding: 30px; margin: 30px 0;">
                    <h3 style="color: #461068; margin-bottom: 20px; font-size: 0.85em;">üìã Votre situation</h3>
                    <p style="font-size: 0.85em; color: #1a1a1a; margin-bottom: 25px;">
                        Est-ce qu'un ou plusieurs participants vont <strong>devenir NOUVEAUX b√©n√©ficiaires effectifs</strong> de la soci√©t√© ?
                    </p>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
                        <strong style="color: #461068; display: block; margin-bottom: 10px;">‚ö†Ô∏è "Nouveau" b√©n√©ficiaire effectif signifie :</strong>
                        <p style="color: #666; margin: 0; line-height: 1.7;">
                            La personne n'√©tait <strong>PAS</strong> b√©n√©ficiaire effectif avant l'augmentation de capital, 
                            et elle le devient apr√®s l'op√©ration (en atteignant l'un des crit√®res ci-dessus).
                        </p>
                    </div>

                    <!-- Radio buttons for YES/NO -->
                    <div style="margin: 20px 0;">
                        <div style="background: #FAFFA4; border: 2px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s ease;" onclick="selectPPAnswer('yes')" id="pp-yes-card">
                            <label style="display: flex; align-items: center; cursor: pointer; margin: 0;">
                                <input type="radio" name="ppNewBE" value="yes" id="ppNewBEYes" style="width: 24px; height: 24px; margin-right: 15px; cursor: pointer;" onchange="handlePPAnswer('yes')">
                                <span style="font-size: 0.85em; font-weight: 600; color: #705208;">‚úÖ OUI, un ou plusieurs participants vont devenir nouveaux BE</span>
                            </label>
                        </div>

                        <div style="background: #FFC9A6; border: 2px solid #e0e0e0; border-radius: 10px; padding: 20px; cursor: pointer; transition: all 0.3s ease;" onclick="selectPPAnswer('no')" id="pp-no-card">
                            <label style="display: flex; align-items: center; cursor: pointer; margin: 0;">
                                <input type="radio" name="ppNewBE" value="no" id="ppNewBENo" style="width: 24px; height: 24px; margin-right: 15px; cursor: pointer;" onchange="handlePPAnswer('no')">
                                <span style="font-size: 0.85em; font-weight: 600; color: #7A250C;">‚ùå NON, aucun participant ne devient nouveau BE</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevQuestion(3)">‚Üê Pr√©c√©dent</button>
                    <button class="btn btn-primary" onclick="continuePPtoNext()">Continuer ‚Üí</button>
                </div>
            </div>

            <!-- Question 3b: PM Types -->
            <div class="question-section" id="q3-pm">
                <h2 class="question-title">Quels types d'entit√©s participent ?</h2>
                <p class="question-subtitle">Cochez tous les types d'entit√©s concern√©s</p>

                <div class="checkbox-group">
                    <div class="checkbox-card" onclick="toggleCheckbox('pmSocietesFR')">
                        <input type="checkbox" id="pmSocietesFR">
                        <div class="checkbox-content">
                            <div class="checkbox-title">üá´üá∑ Soci√©t√©s fran√ßaises</div>
                            <div class="checkbox-description">SAS, SARL, SA, etc. immatricul√©es en France</div>
                        </div>
                    </div>

                    <div class="checkbox-card" onclick="toggleCheckbox('pmSocietesETR')">
                        <input type="checkbox" id="pmSocietesETR">
                        <div class="checkbox-content">
                            <div class="checkbox-title">üåç Soci√©t√©s √©trang√®res</div>
                            <div class="checkbox-description">Soci√©t√©s immatricul√©es hors de France</div>
                        </div>
                    </div>

                    <div class="checkbox-card" onclick="toggleCheckbox('pmFonds')">
                        <input type="checkbox" id="pmFonds">
                        <div class="checkbox-content">
                            <div class="checkbox-title">üíº Fonds d'investissement</div>
                            <div class="checkbox-description">FCPR, FCPI, FIP, etc. (uniquement France/UE)</div>
                        </div>
                    </div>

                    <div class="checkbox-card" onclick="toggleCheckbox('pmAssociations')">
                        <input type="checkbox" id="pmAssociations">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ü§ù Associations</div>
                            <div class="checkbox-description">Associations loi 1901 ou √©quivalent √©tranger</div>
                        </div>
                    </div>

                    <div class="checkbox-card" onclick="toggleCheckbox('pmFondations')">
                        <input type="checkbox" id="pmFondations">
                        <div class="checkbox-content">
                            <div class="checkbox-title">üèõÔ∏è Fondations</div>
                            <div class="checkbox-description">Fondations reconnues d'utilit√© publique ou √©quivalent</div>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevQuestion(3)">‚Üê Pr√©c√©dent</button>
                    <button class="btn btn-primary" onclick="generateResults()">Voir mes documents ‚Üí</button>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="results">
                <h2 class="result-title">‚úÖ Vos Documents Requis</h2>
                <p class="result-subtitle">Voici la liste personnalis√©e des documents √† fournir pour votre augmentation de capital</p>

                <div id="resultsContent"></div>

                <div style="display: flex; gap: 15px; margin-top: 30px; align-items: center;">
                    <button class="btn btn-secondary" onclick="goBackFromResults()" style="flex: 1;">‚Üê Retour en arri√®re</button>
                    <button onclick="printResults()" style="
                        background: #461068;
                        color: white;
                        border: none;
                        padding: 10px 25px;
                        border-radius: 8px;
                        font-size: 0.9em;
                        font-weight: 600;
                        cursor: pointer;
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                        box-shadow: 0 2px 8px rgba(70, 16, 104, 0.3);
                        transition: all 0.3s ease;
                        flex: 1;
                    " onmouseover="this.style.background='#350a4d'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(70, 16, 104, 0.4)'" onmouseout="this.style.background='#461068'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(70, 16, 104, 0.3)'">
                        üì• T√©l√©charger PDF
                    </button>
                    <button class="btn btn-primary" onclick="restart()" style="flex: 1; background: #093B75;">üîÑ Retour au d√©but</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let answers = {
            participants: null,
            type: null,
            hasNewBE: false,
            pmTypes: []
        };

        let currentStep = 1;

        // Initialize
        updateProgress();

        // Option selection
        function selectOption(question, value) {
            const radio = document.getElementById(value);
            radio.checked = true;
            
            // Update all cards in this question
            const cards = document.querySelectorAll(`#${question} .option-card`);
            cards.forEach(card => card.classList.remove('selected'));
            radio.closest('.option-card').classList.add('selected');

            // Enable next button
            document.getElementById(`btn-${question}`).disabled = false;

            // Store answer
            if (question === 'q1') {
                answers.participants = value;
            } else if (question === 'q2') {
                answers.type = value;
            }
        }

        // Checkbox toggle
        function toggleCheckbox(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            
            const card = checkbox.closest('.checkbox-card');
            if (checkbox.checked) {
                card.classList.add('checked');
            } else {
                card.classList.remove('checked');
            }

            // Update answers
            if (id === 'hasNewBE') {
                answers.hasNewBE = checkbox.checked;
            } else if (id.startsWith('pm')) {
                if (checkbox.checked) {
                    answers.pmTypes.push(id);
                } else {
                    answers.pmTypes = answers.pmTypes.filter(t => t !== id);
                }
            }
        }

        function updatePPCheckboxes() {
            // Just update state, no validation needed
        }

        // Handle PP answer selection (YES/NO for new BE)
        function selectPPAnswer(answer) {
            const radio = document.getElementById(answer === 'yes' ? 'ppNewBEYes' : 'ppNewBENo');
            radio.checked = true;
            handlePPAnswer(answer);
        }

        function handlePPAnswer(answer) {
            // Update visual state
            const yesCard = document.getElementById('pp-yes-card');
            const noCard = document.getElementById('pp-no-card');
            
            if (answer === 'yes') {
                yesCard.style.borderColor = '#705208';
                yesCard.style.borderWidth = '3px';
                noCard.style.borderColor = '#e0e0e0';
                noCard.style.borderWidth = '2px';
                answers.hasNewBE = true;
            } else {
                noCard.style.borderColor = '#7A250C';
                noCard.style.borderWidth = '3px';
                yesCard.style.borderColor = '#e0e0e0';
                yesCard.style.borderWidth = '2px';
                answers.hasNewBE = false;
            }
        }

        // Navigation
        function nextQuestion(current) {
            // Hide current question
            document.getElementById(`q${current}`).classList.remove('active');
            
            if (current === 1) {
                if (answers.participants === 'single-holder') {
                    // Only single participant who is account holder: go directly to results
                    showResults();
                    return;
                } else if (answers.participants === 'other') {
                    // All other situations: continue to Q2
                    currentStep = 2;
                    document.getElementById('q2').classList.add('active');
                }
            } else if (current === 2) {
                currentStep = 3;
                // Show appropriate Q3 based on type
                if (answers.type === 'pp' || answers.type === 'mix') {
                    document.getElementById('q3-pp').classList.add('active');
                } else {
                    document.getElementById('q3-pm').classList.add('active');
                }
            }

            updateProgress();
        }

        function continuePPtoNext() {
            // From PP question, go to PM if mix, otherwise to results
            if (answers.type === 'mix') {
                document.getElementById('q3-pp').classList.remove('active');
                document.getElementById('q3-pm').classList.add('active');
            } else {
                // PP only, go to results
                generateResults();
            }
        }

        function prevQuestion(current) {
            document.querySelector('.question-section.active').classList.remove('active');
            
            if (current === 2) {
                currentStep = 1;
                document.getElementById('q1').classList.add('active');
            } else if (current === 3) {
                currentStep = 2;
                document.getElementById('q2').classList.add('active');
            }

            updateProgress();
        }

        function updateProgress() {
            // Update step indicators
            document.querySelectorAll('.step').forEach(step => {
                const stepNum = parseInt(step.dataset.step);
                step.classList.remove('active', 'completed');
                
                if (stepNum === currentStep) {
                    step.classList.add('active');
                } else if (stepNum < currentStep) {
                    step.classList.add('completed');
                }
            });

            // Update progress line
            const progress = ((currentStep - 1) / 3) * 100;
            document.getElementById('progressLine').style.width = progress + '%';
        }

        function showResults() {
            currentStep = 4;
            document.querySelectorAll('.question-section').forEach(q => q.classList.remove('active'));
            generateResults();
        }

        // Results generation
        function generateResults() {
            currentStep = 4;
            updateProgress();
            
            document.querySelectorAll('.question-section').forEach(q => q.classList.remove('active'));
            document.getElementById('results').classList.add('active');

            let html = '';

            // Single participant who is account holder case
            if (answers.participants === 'single-holder') {
                html += `
                    <div class="summary-box">
                        <h4>üìä Votre situation</h4>
                        <ul>
                            <li>Participant unique (titulaire du compte)</li>
                            <li>Cas simplifi√© avec documents minimaux</li>
                        </ul>
                    </div>

                    <div class="doc-category">
                        <h3>üìã Documents √† fournir</h3>
                        
                        <div class="doc-item">
                            <div class="doc-item-title">‚úì Pi√®ce d'identit√© en cours de validit√©</div>
                            <div class="doc-item-description">
                                √Ä transmettre si l'identit√© n'a pas √©t√© v√©rifi√©e lors de l'ouverture du compte ou si le document pr√©c√©demment transmis a expir√© 
                                (<a href="https://support-fr.qonto.com/hc/fr/articles/38720641656977-Quels-documents-sont-demand%C3%A9s-aux-personnes-physiques-dans-le-cadre-d-une-augmentation-de-capital-en-France#h_01K4A66FEWEJZ47VQXV71EYG1T" target="_blank">voir quels documents d'identit√© sont accept√©s</a>)
                            </div>
                        </div>

                        <div class="doc-item">
                            <div class="doc-item-title">‚úì D√©claration d'origine des fonds</div>
                            <div class="doc-item-description">
                                Document √† remplir disponible en pi√®ce jointe de l'email
                            </div>
                        </div>

                        <div class="doc-item">
                            <div class="doc-item-title">‚úì Preuve documentaire de l'origine des fonds</div>
                            <div class="doc-item-description">
                                (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVBCTV7ZRXK5DX9P790V" target="_blank">voir quels documents justificatifs sont accept√©s</a>)
                            </div>
                        </div>
                    </div>
                `;
            } else {
                // All other situations
                html += '<div class="summary-box"><h4>üìä Votre situation</h4><ul>';
                
                if (answers.type === 'pp') {
                    html += '<li>Personnes physiques uniquement</li>';
                } else if (answers.type === 'pm') {
                    html += '<li>Personnes morales uniquement</li>';
                } else {
                    html += '<li>Mix personnes physiques et morales</li>';
                }

                if (answers.hasNewBE) html += '<li>Avec nouveaux b√©n√©ficiaires effectifs</li>';
                
                html += '</ul></div>';

                // PP Documents
                if (answers.type === 'pp' || answers.type === 'mix') {
                    html += generatePPResults();
                }

                // PM Documents
                if (answers.type === 'pm' || answers.type === 'mix') {
                    html += generatePMResults();
                }
            }

            document.getElementById('resultsContent').innerHTML = html;
        }

        function generatePPResults() {
            let html = '<div class="doc-category"><h3>üë§ Personnes Physiques</h3>';

            // SECTION 1: Universal documents for ALL PP (blue header)
            html += `
                <div style="background: #093B75; color: white; padding: 15px 25px; border-radius: 8px 8px 0 0; margin-bottom: 0;">
                    <h4 style="margin: 0; font-size: 0.85em; font-weight: 600;">üìã Documents requis pour TOUS les participants personnes physiques</h4>
                </div>
            `;

            // Document 1: D√©claration (connected to header)
            html += `
                <div class="doc-item" style="margin-top: 0; border-radius: 0;">
                    <div class="doc-item-title">‚úì D√©claration d'origine des fonds</div>
                    <div class="doc-item-description">
                        Document √† remplir disponible en pi√®ce jointe de l'email (version personnes physiques). 
                        √Ä compl√©ter et signer par toutes les personnes physiques qui participent √† l'op√©ration.
                    </div>
                </div>
            `;

            // Document 2: Pi√®ce d'identit√© (last in blue section)
            html += `
                <div class="doc-item" style="margin-top: 0; border-radius: 0 0 8px 8px;">
                    <div class="doc-item-title">‚úì Pi√®ce d'identit√© en cours de validit√©</div>
                    <div class="doc-item-description">
                        √Ä transmettre si l'identit√© n'a pas √©t√© v√©rifi√©e lors de l'ouverture du compte ou si le document pr√©c√©demment transmis a expir√©. 
                        (<a href="https://support-fr.qonto.com/hc/fr/articles/38720641656977-Quels-documents-sont-demand%C3%A9s-aux-personnes-physiques-dans-le-cadre-d-une-augmentation-de-capital-en-France#h_01K4A66FEWEJZ47VQXV71EYG1T" target="_blank">voir quels documents d'identit√© sont accept√©s</a>)
                    </div>
                </div>
            `;

            // SECTION 2: Additional documents for ‚â•25% (orange header)
            html += `
                <div style="background: #FFC9A6; color: #7A250C; padding: 15px 25px; border-radius: 8px 8px 0 0; margin-top: 30px; margin-bottom: 0;">
                    <h4 style="margin: 0; font-size: 0.85em; font-weight: 600;">üìù Document additionnel pour les personnes physiques qui vont d√©tenir ‚â• 25% du capital social APR√àS l'augmentation de capital</h4>
                </div>
            `;

            // Document 3: Preuve origine fonds (orange section)
            html += `
                <div class="doc-item" style="margin-top: 0; border-radius: 0 0 8px 8px;">
                    <div class="doc-item-title">‚úì Preuve documentaire de l'origine des fonds</div>
                    <div class="doc-item-description">
                        üí° <em>Consultez votre table de capitalisation (cap table) pour identifier quels participants d√©tiendront ‚â• 25% du capital post-op√©ration.</em>
                        <br><br>
                        (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVBCTV7ZRXK5DX9P790V" target="_blank">voir quels documents justificatifs sont accept√©s</a>)
                    </div>
                </div>
            `;

            // SECTION 3: Formulaire B√©n√©ficiaire effectif (if applicable) - separate orange section
            if (answers.hasNewBE) {
                html += `
                    <div style="background: #FFC9A6; color: #7A250C; padding: 15px 25px; border-radius: 8px 8px 0 0; margin-top: 30px; margin-bottom: 0;">
                        <h4 style="margin: 0; font-size: 0.85em; font-weight: 600;">üìù Document additionnel pour nouveaux b√©n√©ficiaires effectifs</h4>
                    </div>
                    <div class="doc-item" style="margin-top: 0; border-radius: 0 0 8px 8px;">
                        <div class="doc-item-title">‚úì Formulaire d'auto-d√©claration</div>
                        <div class="doc-item-description">
                            Pour chaque personne qui devient nouveau b√©n√©ficiaire effectif (n'√©tait PAS b√©n√©ficiaire effectif avant l'op√©ration et le devient apr√®s). 
                            Document √† remplir disponible en pi√®ce jointe de l'email.
                        </div>
                    </div>
                `;
            }

            html += '</div>';
            return html;
        }

        function generatePMResults() {
            let html = '<div class="doc-category"><h3>üè¢ Personnes Morales</h3>';

            // Instruction card
            html += `
                <div class="doc-item">
                    <div class="doc-item-title">üìä Comment utiliser les tableaux ci-dessous ?</div>
                    <div class="doc-item-description">
                        <strong>Pour CHAQUE participant</strong> personne morale √† l'augmentation de capital :<br>
                        1Ô∏è‚É£ Consultez votre <strong>table de capitalisation (cap table)</strong><br>
                        2Ô∏è‚É£ Identifiez le <strong>% de capital que d√©tiendra ce participant APR√àS l'op√©ration</strong><br>
                        3Ô∏è‚É£ Trouvez la ligne correspondante dans le tableau<br>
                        4Ô∏è‚É£ Collectez les documents list√©s pour ce participant
                    </div>
                </div>
            `;

            // Universal document section - ONLY if non-fund entities are selected
            const hasNonFundEntities = answers.pmTypes.some(type => type !== 'pmFonds');
            const onlyFunds = answers.pmTypes.length === 1 && answers.pmTypes.includes('pmFonds');
            
            if (hasNonFundEntities) {
                // Universal document section header
                html += `
                    <div style="background: #093B75; color: white; padding: 15px 25px; border-radius: 8px 8px 0 0; margin-top: 30px; margin-bottom: 0;">
                        <h4 style="margin: 0; font-size: 0.85em; font-weight: 600;">üìã Document requis pour TOUS les participants personnes morales</h4>
                    </div>
                `;

                // Universal document card (connected to header)
                const hasFunds = answers.pmTypes.includes('pmFonds');
                html += `
                    <div class="doc-item" style="margin-top: 0; border-radius: 0 0 8px 8px;">
                        <div class="doc-item-title">‚úì D√©claration d'origine des fonds</div>
                        <div class="doc-item-description">
                            Document √† remplir disponible en pi√®ce jointe de l'email (version personnes morales)
                            ${hasFunds ? '<br><br>‚ö†Ô∏è <em>√Ä l\'exception des fonds d\'investissement</em>' : ''}
                        </div>
                    </div>
                `;
            }

            // Show tables for selected PM types ONLY
            if (answers.pmTypes.includes('pmSocietesFR')) {
                html += generateSocietesFRTable();
            }
            if (answers.pmTypes.includes('pmSocietesETR')) {
                html += generateSocietesETRTable();
            }
            if (answers.pmTypes.includes('pmFonds')) {
                html += generateFondsTable();
            }
            if (answers.pmTypes.includes('pmAssociations')) {
                html += generateAssociationsTable();
            }
            if (answers.pmTypes.includes('pmFondations')) {
                html += generateFondationsTable();
            }

            html += '</div>';
            return html;
        }

        function generateSocietesFRTable() {
            return `
                <h4 style="margin: 25px 0 15px 0;">üá´üá∑ Soci√©t√©s Fran√ßaises</h4>
                <table class="pm-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">% capital d√©tenu par le participant apr√®s l'augmentation</th>
                            <th>Documents √† demander pour ce participant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 25%</td>
                            <td>
                                <div class="doc-list">‚úì Extrait Kbis/INPI/Pappers (&lt; 3 mois)</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© du repr√©sentant l√©gal</div>
                            </td>
                        </tr>
                        <tr>
                            <td>‚â• 25%</td>
                            <td>
                                <div class="doc-list">‚úì Extrait Kbis/INPI/Pappers (&lt; 3 mois)</div>
                                <div class="doc-list">‚úì Statuts √† jour</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© du repr√©sentant l√©gal</div>
                                <div class="doc-list">‚úì Pouvoirs du repr√©sentant l√©gal</div>
                                <div class="doc-list"><strong>‚úì Preuve documentaire de l'origine des fonds</strong> (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVC8SX6778VWKBZTWE7M" target="_blank">voir quels documents justificatifs sont accept√©s</a>)</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function generateSocietesETRTable() {
            return `
                <h4 style="margin: 25px 0 15px 0;">üåç Soci√©t√©s √âtrang√®res</h4>
                <table class="pm-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">% capital d√©tenu par le participant apr√®s l'augmentation</th>
                            <th>Documents √† demander pour ce participant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 25%</td>
                            <td>
                                <div class="doc-list">‚úì Certificat d'immatriculation (&lt; 3 mois, traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© du repr√©sentant l√©gal</div>
                            </td>
                        </tr>
                        <tr>
                            <td>‚â• 25%</td>
                            <td>
                                <div class="doc-list">‚úì Certificat d'immatriculation (&lt; 3 mois, traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Certificat "good standing" (&lt; 3 mois, traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Statuts en vigueur</div>
                                <div class="doc-list">‚úì Num√©ro fiscal + LEI si applicable</div>
                                <div class="doc-list">‚úì Registre administrateurs/dirigeants</div>
                                <div class="doc-list">‚úì Organigramme complet</div>
                                <div class="doc-list">‚úì Pouvoirs signataires</div>
                                <div class="doc-list">‚úì Structure actionnariat (jusqu'aux B√©n√©ficiaires effectifs ‚â•25%)</div>
                                <div class="doc-list">‚úì Comptes annuels (3 derni√®res ann√©es)</div>
                                <div class="doc-list"><strong>‚úì Preuve documentaire de l'origine des fonds</strong> (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVC8SX6778VWKBZTWE7M" target="_blank">voir quels documents justificatifs sont accept√©s</a>)</div>
                                <div style="background: #f8f9fa; padding: 12px; margin-top: 10px; border-radius: 6px;">
                                    <strong>Pour chaque B√©n√©ficiaire effectif ‚â• 25% :</strong><br>
                                    ‚úì Pi√®ce d'identit√©<br>
                                    ‚úì Justificatif domicile
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function generateFondsTable() {
            return `
                <h4 style="margin: 25px 0 15px 0;">üíº Fonds d'Investissement</h4>
                <div style="background: #FFDFEA; border-left: 5px solid #7E0F4C; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong style="color: #7E0F4C;">üö´ IMPORTANT</strong>
                    <p style="color: #7E0F4C; margin: 5px 0 0 0;">Les fonds d'investissement hors UE ne sont PAS accept√©s</p>
                </div>
                <table class="pm-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">% capital d√©tenu par le participant apr√®s l'augmentation</th>
                            <th>Documents √† demander pour ce participant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 25%</td>
                            <td>
                                <div class="doc-list">‚úì Prospectus du fonds (traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© repr√©sentant soci√©t√© de gestion</div>
                            </td>
                        </tr>
                        <tr>
                            <td>‚â• 25%</td>
                            <td>
                                <div class="doc-list">‚úì Prospectus du fonds (traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Nom du gestionnaire</div>
                                <div class="doc-list">‚úì Preuve agr√©ment soci√©t√© de gestion (AMF/UE)</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© repr√©sentant</div>
                                <div class="doc-list"><strong>‚úì Preuve documentaire de l'origine des fonds</strong> (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVC8SX6778VWKBZTWE7M" target="_blank">voir quels documents justificatifs sont accept√©s</a>)</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function generateAssociationsTable() {
            return `
                <h4 style="margin: 25px 0 15px 0;">ü§ù Associations</h4>
                <table class="pm-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">% capital d√©tenu par le participant apr√®s l'augmentation</th>
                            <th>Documents √† demander pour ce participant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 25%</td>
                            <td>
                                <div class="doc-list">‚úì Avis INSEE (FR) ou √©quivalent (traduit en fran√ßais)</div>
                            </td>
                        </tr>
                        <tr>
                            <td>‚â• 25%</td>
                            <td>
                                <div class="doc-list">‚úì Avis INSEE ou √©quivalent (traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Statuts √† jour</div>
                                <div class="doc-list">‚úì R√©c√©piss√© de d√©claration</div>
                                <div class="doc-list"><strong>‚úì Preuve documentaire de l'origine des fonds</strong> (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVC8SX6778VWKBZTWE7M" target="_blank">voir quels documents justificatifs sont accept√©s</a>)</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function generateFondationsTable() {
            return `
                <h4 style="margin: 25px 0 15px 0;">üèõÔ∏è Fondations</h4>
                <table class="pm-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">% capital d√©tenu par le participant apr√®s l'augmentation</th>
                            <th>Documents √† demander pour ce participant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 25%</td>
                            <td>
                                <div class="doc-list">‚úì Acte constitutif/charte (traduit en fran√ßais)</div>
                            </td>
                        </tr>
                        <tr>
                            <td>‚â• 25%</td>
                            <td>
                                <div class="doc-list">‚úì Acte constitutif/charte (traduit en fran√ßais)</div>
                                <div class="doc-list">‚úì Certificat d'enregistrement</div>
                                <div class="doc-list">‚úì Num√©ro fiscal</div>
                                <div class="doc-list">‚úì Statuts + liste membres</div>
                                <div class="doc-list">‚úì Objectifs et finalit√©</div>
                                <div class="doc-list">‚úì Pi√®ce d'identit√© + domicile membres</div>
                                <div class="doc-list">‚úì Comptes annuels + fiscales</div>
                                <div class="doc-list">‚úì Organigramme complet</div>
                                <div class="doc-list">‚úì D√©claration BE</div>
                                <div class="doc-list"><strong>‚úì Preuve documentaire de l'origine des fonds</strong> (<a href="https://support-fr.qonto.com/hc/fr/articles/38738891662737-Quels-documents-peuvent-%C3%AAtre-fournis-comme-preuve-de-l-origine-des-fonds#h_01K4AXEVC8SX6778VWKBZTWE7M" target="_blank">voir quels documents justificatifs sont accept√©s</a>)</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function printResults() {
            console.log("Bouton PDF cliqu√© - Ouverture de l'impression...");
            setTimeout(function() {
                try {
                    window.print();
                } catch (error) {
                    console.error("Erreur d'impression:", error);
                    alert("Pour t√©l√©charger en PDF :\n\n1. Utilisez Ctrl+P (Windows/Linux) ou Cmd+P (Mac)\n2. S√©lectionnez 'Enregistrer en PDF' comme destination\n3. Cliquez sur Enregistrer");
                }
            }, 100);
        }

        function restart() {
            // Reset all answers
            answers = {
                participants: null,
                type: null,
                hasNewBE: false,
                pmTypes: []
            };

            // Reset UI
            currentStep = 1;
            document.querySelectorAll('.option-card').forEach(card => card.classList.remove('selected'));
            document.querySelectorAll('.checkbox-card').forEach(card => card.classList.remove('checked'));
            document.querySelectorAll('input[type="radio"]').forEach(input => input.checked = false);
            document.querySelectorAll('input[type="checkbox"]').forEach(input => input.checked = false);
            document.querySelectorAll('.btn-primary').forEach(btn => btn.disabled = true);

            // Reset PP answer cards borders
            const yesCard = document.getElementById('pp-yes-card');
            const noCard = document.getElementById('pp-no-card');
            if (yesCard) {
                yesCard.style.borderColor = '#e0e0e0';
                yesCard.style.borderWidth = '2px';
            }
            if (noCard) {
                noCard.style.borderColor = '#e0e0e0';
                noCard.style.borderWidth = '2px';
            }

            // Show first question
            document.getElementById('results').classList.remove('active');
            document.querySelectorAll('.question-section').forEach(q => q.classList.remove('active'));
            document.getElementById('q1').classList.add('active');

            updateProgress();
        }

        function goBackFromResults() {
            // Hide results
            document.getElementById('results').classList.remove('active');
            
            // Determine which question to show based on answers
            if (answers.participants === 'single-holder') {
                // Go back to Q1
                currentStep = 1;
                document.getElementById('q1').classList.add('active');
            } else if (answers.type === 'pm') {
                // Go back to PM question
                currentStep = 3;
                document.getElementById('q3-pm').classList.add('active');
            } else if (answers.type === 'mix') {
                // For mix, go back to PM question (last one visited)
                currentStep = 3;
                document.getElementById('q3-pm').classList.add('active');
            } else if (answers.type === 'pp') {
                // Go back to PP question
                currentStep = 3;
                document.getElementById('q3-pp').classList.add('active');
            } else {
                // Fallback to Q2
                currentStep = 2;
                document.getElementById('q2').classList.add('active');
            }
            
            updateProgress();
        }
    </script>
</body>
</html>
